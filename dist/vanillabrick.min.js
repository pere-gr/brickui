(()=>{var rt=Object.defineProperty;var it=(t,e)=>{for(var n in e)rt(t,n,{get:e[n],enumerable:!0})};function x(t){this.brick=t,this._status="initializing",this._listening=!1;var e=this;t&&(t.status={get:function(){return e.get()},set:function(n){return e.set(n)},is:function(n){return e.is(n)}})}x.prototype.get=function(){return this._status};x.prototype.set=function(t,e){if(!this.brick.events){this._status=t;return}if(!this._listening){var n=this;this.brick.events.on("brick:status:*","on",function(r){r.data&&r.data.status&&(n._status=r.data.status)}),this._listening=!0}var o=Object.assign({},e||{},{status:t,from:this._status});this.brick.events.fire("brick:status:"+t,o)};x.prototype.is=function(t){return this._status===t};function k(t){this.brick=t||null}k.prototype.execute=function(t,e,n,o){"use strict";if(typeof t!="function"){console.warn("[RuntimeController] Attempted to execute non-function",o);return}try{let r=t.apply(e,n);return r&&typeof r.then=="function"?r.catch(function(i){return this._handleError(i,t,e,o),Promise.reject(i)}.bind(this)):r}catch(r){throw this._handleError(r,t,e,o),r}};k.prototype._handleError=function(t,e,n,o){var r=n&&n.brick?n.brick:n;let i={error:t,message:t.message||String(t),stack:t.stack,meta:o||{},context:{brick:r&&r.id?r.id:null,kind:r&&r.kind?r.kind:null}};try{i.fnSource=e.toString()}catch(a){i.fnSource="[unable to capture source]"}console.error("[RuntimeController] Error executing developer code:",i)};k.prototype.wrap=function(t,e,n){if(typeof t!="function")return t;let o=this;return function(){let i=Array.prototype.slice.call(arguments);return o.execute(t,e,i,n)}};function g(t,e){if(this.brick=t,this.data={},this._cache={},this._eventsBound=!1,e&&typeof e=="object")for(let o in e)Object.prototype.hasOwnProperty.call(e,o)&&L(this.data,_(o),e[o]);var n=this;t.options={get:function(o,r){return n.get(o,r)},set:function(o,r){return n.setSync(o,r),t},setAsync:async function(o,r){return await n.setAsync(o,r),t},has:function(o){return n.has(o)},all:function(){return n.all()},setSilent:function(o,r){return n.setSilent(o,r),t}}}g.prototype._ensureEventsBinding=function(){if(!this._eventsBound){var t=this.brick,e=this;t.events.on("options:value:*","on",5,function(n){e._apply(n)}),this._eventsBound=!0}};g.prototype._apply=function(t){if(t){var e=t.data||{};if(this._cache={},e.batch&&e.values&&typeof e.values=="object"){for(var n in e.values)Object.prototype.hasOwnProperty.call(e.values,n)&&L(this.data,_(n),e.values[n]);return}typeof e.key=="string"&&L(this.data,_(e.key),e.value)}};g.prototype.setAsync=async function(t,e){this._ensureEventsBinding();var n=this.brick;if(t&&typeof t=="object"&&!Array.isArray(t)){var o={},r={};P(t,"",o);for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=A(this.data,i));var a={batch:!0,values:o,previous:r,options:this,brick:n};return await n.events.fireAsync("options:value:batch",a),this}var s=A(this.data,t),c={key:t,value:e,previous:s,options:this,brick:n};return await n.events.fireAsync("options:value:"+t,c),this};g.prototype.setSync=function(t,e){this._ensureEventsBinding();var n=this.brick;if(t&&typeof t=="object"&&!Array.isArray(t)){var o={},r={};P(t,"",o);for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=A(this.data,i));var a={batch:!0,values:o,previous:r,options:this,brick:n};return n.events.fire("options:value:batch",a),this}var s=A(this.data,t),c={key:t,value:e,previous:s,options:this,brick:n};return n.events.fire("options:value:"+t,c),this};g.prototype.set=g.prototype.setAsync;g.prototype.setSilent=function(t,e){return this._cache={},t&&typeof t=="object"&&!Array.isArray(t)?(P(t,"",this.data),this):(L(this.data,_(t),e),this)};g.prototype.get=function(t,e){if(Object.prototype.hasOwnProperty.call(this._cache,t))return this._cache[t];var n=A(this.data,t),o=typeof n=="undefined"?e:n;return this._cache[t]=o,o};g.prototype.has=function(t){var e=_(t);if(!e.length)return!1;var n=ct(this.data,e);return n?!0:Object.prototype.hasOwnProperty.call(this.data,t)};g.prototype.all=function(){return Object.assign({},this.data)};function _(t){return!t&&t!==0?[]:Array.isArray(t)?t:String(t).split(".").filter(function(e){return e!==""})}function L(t,e,n){if(e.length){for(var o=t,r=0;r<e.length-1;r+=1){var i=e[r];(!o[i]||typeof o[i]!="object")&&(o[i]={}),o=o[i]}o[e[e.length-1]]=n}}function st(t,e){for(var n=t,o=0;o<e.length;o+=1){var r=e[o];if(!n||!Object.prototype.hasOwnProperty.call(n,r))return;n=n[r]}return n}function ct(t,e){for(var n=t,o=0;o<e.length;o+=1){var r=e[o];if(!n||!Object.prototype.hasOwnProperty.call(n,r))return!1;n=n[r]}return!0}function A(t,e){var n=_(e);if(n.length){var o=st(t,n);if(typeof o!="undefined")return o}if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function P(t,e,n){for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var r=e?e+"."+o:o,i=t[o];i&&typeof i=="object"&&!Array.isArray(i)?P(i,r,n):n[r]=i}}function y(t){this.brick=t||null,this.handlers=[],this._dispatchCache={},this.phases=["before","on","after"];var e=this;t&&(t.events={on:function(n,o,r,i,a){return e.on(n,o,r,i,a),t},off:function(n,o,r){return e.off(n,o,r),t},fire:function(n,o){return e.fire(n,o),t},fireAsync:function(n,o){return e.fireAsync(n,o)}})}y.prototype._normalizePriority=function(t){let e=typeof t=="number"?t:5;return e<0&&(e=0),e>10&&(e=10),e};y.prototype._compilePattern=function(t){let e=(t||"").split(":"),n=e[0],o=e[1],r=e[2];return{namespace:!n||n==="*"?void 0:n,type:!o||o==="*"?void 0:o,target:!r||r==="*"?void 0:r}};y.prototype._parseEventKey=function(t){let e=(t||"").split(":");return{namespace:e[0]||"",type:e[1]||"",target:e[2]||""}};y.prototype._matches=function(t,e){return(t.namespace===void 0||t.namespace===e.namespace)&&(t.type===void 0||t.type===e.type)&&(t.target===void 0||t.target===e.target)};y.prototype._validateEventName=function(t){if(typeof t!="string")return console.error("[EventBus] Event name must be a string.",t),!1;let e=t.split(":");return e.length!==3?(console.error('[EventBus] Invalid event name format. Expected exactly "namespace:type:target" (3 segments). Got:',t),!1):!e[0]||e[0]==="*"||!e[1]||e[1]==="*"||!e[2]||e[2]==="*"?(console.error("[EventBus] Invalid event name for dispatch. Wildcards (*) and empty segments are not allowed in namespace, type, or target.",t),!1):!0};y.prototype._getHandlersForEvent=function(t){if(this._dispatchCache[t])return this._dispatchCache[t];let e=this._parseEventKey(t),n={before:[],on:[],after:[]};for(let o=0;o<this.handlers.length;o+=1){let r=this.handlers[o];this._matches(r.compiled,e)&&n[r.phase]&&n[r.phase].push(r)}return this._dispatchCache[t]=n,n};y.prototype.on=function(t,e,n,o,r){if(typeof e=="function"?(r=o,o=e,e="on",n=void 0):typeof n=="function"&&typeof o!="function"&&(r=o,o=n,n=void 0),typeof o!="function")return;let i=e||"on";this.phases.indexOf(i)===-1&&(i="on");let a=this._normalizePriority(n);this.handlers.push({pattern:t,compiled:this._compilePattern(t),phase:i,handler:o,priority:a,meta:r||null}),this.handlers.sort(function(s,c){let f=typeof s.priority=="number"?s.priority:5,l=typeof c.priority=="number"?c.priority:5;return f-l}),this._dispatchCache={}};y.prototype.off=function(t,e,n){for(let o=this.handlers.length-1;o>=0;o-=1){let r=this.handlers[o];t&&r.pattern!==t||e&&r.phase!==e||n&&r.handler!==n||this.handlers.splice(o,1)}this._dispatchCache={}};y.prototype._run=async function(t,e){if(!this._validateEventName(t))return{event:{name:t},errors:[{error:"Invalid event name format or wildcards in dispatch"}],cancel:!0};let n=this.phases,o=this._getHandlersForEvent(t),r=this._parseEventKey(t),i={brick:this.brick||null,cancel:!1,data:e,errors:[],event:{phase:null,name:t,namespace:r.namespace,type:r.type,target:r.target},stopPhase:!1};for(let a=0;a<n.length;a+=1){let s=n[a];if(s==="on"&&i.cancel)continue;i.event.phase=s;let c=o[s]||[];for(let f=0;f<c.length&&!i.stopPhase;f+=1){let l=c[f];try{let d=l.handler(i,{brick:this.brick});d&&typeof d.then=="function"&&await d}catch(d){console.error("Error in handler",l.handler,{pattern:l.pattern,phase:l.phase,meta:l.meta},d),i.errors.push({error:d,meta:l.meta,pattern:l.pattern,phase:l.phase}),i.cancel=!0}}}return i};y.prototype.fire=function(t,e){this._run(t,e)};y.prototype.fireAsync=function(t,e){return this._run(t,e)};var ft={_cache:{},all:function(t){if(!t||typeof t!="object")return console.warn("ExtensionsRegistry.all() called without brick context"),[];let e=(t.host||"brick").toLowerCase(),n=(t.kind||"").toLowerCase();if(!n)return[];let o=e+"::"+n;if(this._cache[o])return this._cache[o];let r=globalThis.VanillaBrick&&globalThis.VanillaBrick.extensions||{},i={},a=new Set;function s(u){if(!u||typeof u!="object")return null;let p=(u.host||"brick").toLowerCase(),h=typeof u.kind=="string"?u.kind.toLowerCase():"";return h?{host:p,kind:h}:null}function c(u,p,h){if(!u)return!1;let m=u.host==="*"||u.host===p,b=u.kind==="*"||u.kind===h;return m&&b}for(let u in r){if(!Object.prototype.hasOwnProperty.call(r,u))continue;let p=r[u];if(!p||typeof p!="object"||a.has(p))continue;p._name||(p._name=p.ns||u);let h=p.for;if(!Array.isArray(h)||!h.length){console.warn("VanillaBrick extension without valid `for` array, skipped",p._name||u);continue}let m=!1;for(let b=0;b<h.length;b+=1){let j=s(h[b]);if(j&&c(j,e,n)){m=!0;break}}m&&(i[u]={name:u,ext:p},a.add(p))}let f=[],l={};function d(u){if(l[u]==="ok")return!0;if(l[u]==="visiting"||l[u]==="missing")return!1;let p=i[u];if(!p){for(let m in i)if(i[m].ext.ns===u){p=i[m];break}}if(!p)return l[u]="missing",!1;l[u]="visiting";let h=p.ext.requires||p.ext._requires;if(Array.isArray(h))for(let m=0;m<h.length;m++){let b=h[m];if(!d(b))return l[u]="missing",!1}return l[u]="ok",f.push(p),!0}for(let u in i)d(u);return this._cache[o]=f,f}},q=ft;var F={};it(F,{assertSafeValue:()=>R,deepCloneOptions:()=>C,deepMergeOptions:()=>T,isPlainObject:()=>w,isPollutionKey:()=>I,mergeOptions:()=>E});function w(t){if(!t||typeof t!="object")return!1;let e=Object.getPrototypeOf(t);return e===Object.prototype||e===null}function I(t){return t==="__proto__"||t==="prototype"||t==="constructor"}function R(t,e){return{ok:!0}}function C(t,e){let n=e||"";if(!R(t,n||"<root>").ok)return t;if(Array.isArray(t)){let r=new Array(t.length);for(let i=0;i<t.length;i+=1)r[i]=C(t[i],n?n+"["+i+"]":"["+i+"]");return r}if(w(t)){let r={};for(let i in t){if(!Object.prototype.hasOwnProperty.call(t,i)||I(i))continue;let a=n?n+"."+i:i;r[i]=C(t[i],a)}return r}return t}function T(t){w(t)||(t={});for(let e=1;e<arguments.length;e+=1){let n=arguments[e];if(!(n===null||typeof n=="undefined")){if(!w(n))return C(n,"<root>");for(let o in n){if(!Object.prototype.hasOwnProperty.call(n,o)||I(o))continue;let r=n[o],i=o;if(Array.isArray(r)){t[o]=C(r,i);continue}if(w(r)){w(t[o])||(t[o]={}),T(t[o],r);continue}let a=R(r,i);t[o]=r}}}return t}function E(){let t=Array.prototype.slice.call(arguments);return t.unshift({}),T.apply(null,t)}function lt(t){if(!t)return{ns:"",action:"",target:"*"};let e=String(t).split(":"),n=e[0]||"",o=e[1]||"",r=e.length>2?e.slice(2).join(":"):"*";return r||(r="*"),{ns:n,action:o,target:r}}function D(t){if(typeof t!="function"||t.prototype)return!1;try{return t.toString().indexOf("=>")!==-1}catch(e){return!1}}function O(t){this.brick=t,this.extensions={},this._destroyHook=!1}O.prototype.applyAll=function(){let t=q;if(!t||typeof t.all!="function")return;let e=t.all(this.brick)||[];if(e.length==0){console.warn("No extensions found for this brick",this.brick);return}let n=this.brick._controllers&&this.brick._controllers.options;if(!E||typeof E!="function")console.error("mergeOptions is missing; cannot merge extension defaults safely");else if(n&&typeof n.all=="function"){let o=n.all(),r=(this.brick.kind||"").toLowerCase(),i=[],a=[];for(let c=0;c<e.length;c+=1){let f=e[c],l=f.ext.options||f.ext._options;if(!l)continue;let d=(f.ext.ns||f.name||"").toLowerCase();d&&r&&d===r+"-core"?i.push(l):a.push(l)}let s=E.apply(null,i.concat(a,[o]));n.data=s,n._cache={}}for(let o=0;o<e.length;o+=1)this._install(e[o]);this._ensureDestroyHook()};O.prototype._install=function(t){let e=this.brick,n=t.name||t.ext.ns||null,o=t.ext.ns||n;if(!n){console.warn("VanillaBrick extension without name/ns, skipped",t);return}if(this.extensions[n])return;let r={name:n,def:t.ext,brick:e},i=Object.create(r);i.brick=e,i.ext=r;let a=Object.create(e);a.brick=e,a.ext=r;let s=e._controllers.runtime;if(t.ext.extension&&typeof t.ext.extension=="object")for(let c in t.ext.extension){if(!Object.prototype.hasOwnProperty.call(t.ext.extension,c))continue;let f=t.ext.extension[c];if(typeof f=="function"){D(f)&&console.warn("VanillaBrick: arrow functions discouraged for extension private method",{ns:n,fn:c,kind:e.kind});let l={type:"extension-private",ext:n,brick:e.id,fnName:c};r[c]=function(){let d=Array.prototype.slice.call(arguments);return s&&typeof s.execute=="function"?s.execute(f,i,d,l):f.apply(i,d)}}}if(typeof t.ext.init=="function"){let c=e._controllers.runtime;try{let f;if(c&&typeof c.execute=="function"?f=c.execute(t.ext.init,r,[],{type:"init",ext:n,brick:e.id,fnName:"init"}):f=t.ext.init.call(r),f===!1)return}catch(f){console.error('VanillaBrick extension "'+n+'" init() failed',f);return}}if(t.ext.brick&&typeof t.ext.brick=="object"){e[o]||(e[o]={});let c=e[o];for(let f in t.ext.brick){if(!Object.prototype.hasOwnProperty.call(t.ext.brick,f))continue;let l=t.ext.brick[f];if(typeof l!="function"){console.warn('VanillaBrick extension "'+n+'" api "'+f+'" is not a function');continue}D(l)&&console.warn("VanillaBrick: arrow functions discouraged for brick API",{ns:n,api:f,kind:e.kind}),c[f]&&console.warn("VanillaBrick extension overwriting API "+o+"."+f);let d={type:"brick-api",ext:n,brick:e.id,fnName:o+"."+f};c[f]=function(){let u=Array.prototype.slice.call(arguments);return s&&typeof s.execute=="function"?s.execute(l,a,u,d):l.apply(a,u)}}}if(Array.isArray(t.ext.events)&&t.ext.events.length&&e._controllers&&e._controllers.events&&typeof e._controllers.events.on=="function")for(let c=0;c<t.ext.events.length;c+=1){let f=t.ext.events[c];if(!f)continue;let l=lt(f.for),d=l.ns+":"+l.action+":"+l.target;["before","on","after"].forEach(function(u){let p=f[u];if(!p||typeof p.fn!="function")return;D(p.fn)&&console.warn("VanillaBrick: arrow functions discouraged for event handler",{ns:n,event:m,phase:u,kind:e.kind});let h=typeof p.priority=="number"?p.priority:void 0,m=l.ns+":"+l.action+":"+l.target,b={type:"event",ext:n,brick:e.id,event:m,phase:u,fnName:p.fn.name||"anon"},j=function(ot){let Z=[ot];return s&&typeof s.execute=="function"?s.execute(p.fn,i,Z,b):p.fn.apply(i,Z)};e._controllers.events.on(m,u,h,j,{ext:n,fn:p.fn.name||"anon",extInstance:r})})}this.extensions[n]=r};O.prototype._ensureDestroyHook=function(){if(this._destroyHook)return;let t=this.brick;if(!t||!t._controllers||!t._controllers.events||typeof t._controllers.events.on!="function")return;this._destroyHook=!0;let e=this;t._controllers.events.on("brick:status:destroyed","on",0,function(){for(let n in e.extensions){if(!Object.prototype.hasOwnProperty.call(e.extensions,n))continue;let o=e.extensions[n];if(!o||!o.def)continue;let r=o.def;if(typeof r.destroy=="function"){let i=t._controllers.runtime;try{i&&typeof i.execute=="function"?i.execute(r.destroy,o,[],{type:"destroy",ext:n,brick:t.id,fnName:"destroy"}):r.destroy.call(o)}catch(a){console.error('VanillaBrick extension "'+(r.ns||n||"?")+'" destroy() failed',a)}}}e.extensions={}})};function v(t){let e=t&&typeof t=="object"?Object.assign({},t):{};e.id=e.id||this._nextId(),e.host=(e.host||"brick").toLowerCase(),e.kind=(e.kind||"brick").toLowerCase(),Object.defineProperty(this,"id",{value:e.id,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"host",{value:e.host,writable:!1,configurable:!1,enumerable:!0}),Object.defineProperty(this,"kind",{value:e.kind,writable:!1,configurable:!1,enumerable:!0});let n=Object.freeze({status:new x(this),runtime:new k(this),options:new g(this,e),events:new y(this),extensions:new O(this)});Object.defineProperty(this,"_controllers",{value:n,writable:!1,configurable:!1,enumerable:!1}),n.extensions.applyAll(),n.status.set("ready",{options:e})}v.prototype.destroy=function(){this._controllers.status.set("destroyed")};Object.defineProperty(v,"_idCounter",{value:0,writable:!0,configurable:!1,enumerable:!1});Object.defineProperty(v.prototype,"_nextId",{value:function(){return v._idCounter+=1,"brick-"+v._idCounter},writable:!1,configurable:!1,enumerable:!1});function V(t){t.runtime.services=t.runtime.services||{},t.service=function(e){return t.runtime.services[e]?t.runtime.services[e]:t.base.serviceStart(e)},t.base.serviceStart=function(e){if(t.runtime.services[e])return t.runtime.services[e];let n=t.services[e];if(!n)return console.warn("Service definition not found:",e),null;let o=Object.assign({},n);o.id=e,o.host="service",o.kind=o.kind||"service";let r=new t.brick(o);return t.runtime.services[e]=r,t.runtime.bricks&&Array.isArray(t.runtime.bricks)&&t.runtime.bricks.push(r),r},t.base.serviceStop=function(e){let n=t.runtime.services[e];n&&(n.destroy&&n.destroy(),delete t.runtime.services[e])}}function tt(t){t.base=t.base||{},t.configs=t.configs||{};let e={list:[],byId:{}};function n(s){if(typeof document=="undefined")return;let c=s||document;if(!c.querySelectorAll)return;let f=c.querySelectorAll('script[type="application/json"][data-brick]');for(let l=0;l<f.length;l+=1){let u=f[l].textContent||"";if(u.trim())try{let p=JSON.parse(u);if(!p||typeof p!="object")continue;for(let h in p){if(!Object.prototype.hasOwnProperty.call(p,h))continue;let m=t.configs[h]&&typeof t.configs[h]=="object"?t.configs[h]:{},b=p[h];!b||typeof b!="object"||(t.configs[h]=Object.assign({},m,b))}}catch(p){console.warn("VanillaBrick: invalid JSON in data-brick config",p)}}}function o(s){if(!s)return;let c=s.getAttribute("brick-kind")||s.getAttribute("data-kind")||s.getAttribute("data-brick-kind")||s.dataset&&(s.dataset.kind||s.dataset.brickKind);return c?String(c).toLowerCase():void 0}function r(s){if(!s)return null;if(s.__brickInstance)return s.__brickInstance;let c={},f=s.id&&t.configs?t.configs[s.id]:null;f&&typeof f=="object"&&Object.assign(c,f),s.id&&(c.id=s.id);let l=o(s);l&&(c.kind=l),c.dom={id:s.id||null,element:s};let d=new t.brick(c);return s.__brickInstance=d,e.list.push(d),e.byId[d.id]=d,console.log("Brick",s.id,d),d}function i(s){if(typeof document=="undefined")return[];let c=s||document;if(!c.querySelectorAll)return[];n(c);let f=c.querySelectorAll(".vb"),l=[];for(let d=0;d<f.length;d++){let u=r(f[d]);u&&l.push(u)}return l}if(t.base.bootstrap=i,t.runtime=t.runtime||{},t.runtime.bricks=e.list||[],t.base.getBrick=function(s){return e.byId[s]||null},typeof document!="undefined"){let s=function(){a||(a=!0,i())};var a=!1;document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){s()}):setTimeout(s,0)}}var at={for:[{host:"brick",kind:"*"}],requires:["dom"],ns:"css",options:{},brick:{addClass:function(t){let e=this.dom.element();if(!(!e||!t))if(e.classList&&e.classList.add)e.classList.add(t);else{let n=e.className||"";(" "+n+" ").indexOf(" "+t+" ")===-1&&(e.className=(n?n+" ":"")+t)}},removeClass:function(t){let e=this.dom.element();if(!(!e||!t))if(e.classList&&e.classList.remove)e.classList.remove(t);else{let n=e.className||"";e.className=(" "+n+" ").replace(" "+t+" "," ").trim()}},hasClass:function(t){let e=this.dom.element();return!e||!t?!1:e.classList&&e.classList.contains?e.classList.contains(t):(" "+(e.className||"")+" ").indexOf(" "+t+" ")!==-1},toggleClass:function(t,e){let n=this.dom.element();if(!(!n||!t))if(n.classList&&typeof n.classList.toggle=="function")typeof e=="boolean"?n.classList.toggle(t,e):n.classList.toggle(t);else{let o=this.css.hasClass(t);typeof e=="boolean"?(e&&!o&&this.css.addClass(t),!e&&o&&this.css.removeClass(t)):o?this.css.removeClass(t):this.css.addClass(t)}},show:function(){let t=this.dom.element();t&&(t.style.display="")},hide:function(){let t=this.dom.element();t&&(t.style.display="none")},setStyle:function(t,e){let n=this.dom.element();!n||!t||(n.style[t]=e)},getStyle:function(t){let e=this.dom.element();if(!e||!t||typeof window=="undefined"||!window.getComputedStyle)return null;let n=window.getComputedStyle(e);return n?n.getPropertyValue(t)||n[t]:null},setVar:function(t,e){let n=this.dom.element();!n||!t||(t.indexOf("--")!==0&&(t="--"+t),n.style.setProperty(t,e))},getVar:function(t){let e=this.dom.element();if(!e||!t||typeof window=="undefined"||!window.getComputedStyle)return null;t.indexOf("--")!==0&&(t="--"+t);let n=window.getComputedStyle(e);return n?n.getPropertyValue(t):null}},extension:{},events:[],init:function(){return!this.brick||!this.brick.dom||typeof this.brick.dom.element!="function"?(console.warn("VanillaBrick domCss requires dom extension active",this.brick&&this.brick.id),!1):this.brick.dom.element()?!0:(console.warn("VanillaBrick domCss: no DOM element resolved",this.brick&&this.brick.id),!1)},destroy:function(){}},N=at;var ut={for:[{host:"brick",kind:"*"}],requires:["dom"],ns:"dom",options:{},brick:{},extension:{},events:[{for:"brick:status:ready",on:{fn:function(){let t=this.brick.dom.element();if(!t||typeof t.addEventListener!="function")return;let e=this.brick.options.get("dom.events.listeners",[]);Array.isArray(e)||(e=[]);let n=this,o=[{type:"click",eventName:"dom:mouse:click"},{type:"mouseenter",eventName:"dom:hover:on"},{type:"mouseleave",eventName:"dom:hover:off"},{type:"mousedown",eventName:"dom:mouse:down"},{type:"mouseup",eventName:"dom:mouse:up"}];for(let r=0;r<o.length;r+=1){let i=o[r],a=function(c){n.brick.events.fire(i.eventName,{domEvent:c,element:t})};t.addEventListener(i.type,a),e.push({type:i.type,handler:a,source:"default"})}this.brick.options.setSilent("dom.events.listeners",e)}}},{for:"brick:status:destroyed",before:{fn:function(){let t=this.brick&&this.brick.dom.element&&this.brick.dom.element();if(!t||typeof t.removeEventListener!="function")return;let e=this.brick.options.get("dom.events.listeners",[]);if(Array.isArray(e)){for(let n=0;n<e.length;n+=1){let o=e[n];t.removeEventListener(o.type,o.handler,o.options)}this.brick.options.setSilent("dom.events.listeners",[])}}}}],init:function(){},destroy:function(){}},H=ut;var dt={for:[{host:"brick",kind:"*"}],requires:[],ns:"dom",options:{},brick:{element:function(){return this.options.get("dom.element",null)},on:function(t,e,n){let o=this.options.get("dom.element",null);if(!o||typeof o.addEventListener!="function"||typeof e!="function")return;o.addEventListener(t,e,n);let r=this.options.get("dom.listeners",[]);Array.isArray(r)||(r=[]),r.push({type:t,handler:e,options:n,source:"api"}),this.options.setSilent("dom.listeners",r)},off:function(t,e,n){let o=this.options.get("dom.element",null);if(!o||typeof o.removeEventListener!="function"||typeof e!="function")return;o.removeEventListener(t,e,n);let r=this.options.get("dom.listeners",[]);if(Array.isArray(r)){for(let i=r.length-1;i>=0;i-=1){let a=r[i];a.type===t&&a.handler===e&&r.splice(i,1)}this.options.setSilent("dom.listeners",r)}}},extension:{_resolveElement:function(t){if(!t)return null;if(typeof Element!="undefined"&&t instanceof Element||t&&t.nodeType===1)return t;if(typeof t=="function")try{return t()}catch(e){return null}return null},_resolveById:function(t){return!t||typeof t!="string"||typeof document=="undefined"?null:document.getElementById(t)||null}},events:[],init:function(){if(!this.brick)return!1;let t=this.brick.options.get("dom.element",null),e=this.brick.options.get("dom.id",null),n=this._resolveElement(t);return!n&&e&&(n=this._resolveById(e)),n?(t&&!this._resolveElement(t)&&console.warn("VanillaBrick dom element must be a DOM node or factory, not an id. Use options.dom.id to resolve by id.",this.brick.id),this.brick.options.set("dom.element",n),!0):(console.warn("VanillaBrick dom extension requires a DOM element (options.dom.element) or a valid options.dom.id",this.brick.id),!1)},destroy:function(){let t=this.brick.options.get("dom.element",null),e=this.brick.options.get("dom.listeners",null);if(t&&Array.isArray(e))for(let n=0;n<e.length;n+=1){let o=e[n];o&&o.type&&o.handler&&t.removeEventListener(o.type,o.handler,o.options)}}},M=dt;var pt=[{code:"1",name:"one",key:1},{code:"2",name:"two",key:2},{code:"3",name:"three",key:3},{code:"4",name:"four",key:4},{code:"5",name:"five",key:5},{code:"6",name:"six",key:6},{code:"7",name:"seven",key:7},{code:"8",name:"eight",key:8},{code:"9",name:"nine",key:9},{code:"10",name:"ten",key:10},{code:"11",name:"eleven",key:11},{code:"12",name:"twelve",key:12},{code:"13",name:"thirteen",key:13},{code:"14",name:"fourteen",key:14},{code:"15",name:"fifteen",key:15},{code:"16",name:"sixteen",key:16},{code:"17",name:"seventeen",key:17},{code:"18",name:"eighteen",key:18},{code:"19",name:"nineteen",key:19},{code:"20",name:"twenty",key:20}],ht={for:[{host:"brick",kind:"form"},{host:"brick",kind:"grid"}],requires:[],ns:"store",options:{},brick:{load:function(){return this.options.get("store.data",[])},set:function(t){if(t===null)return;let e=this.options.get("store.data",[]);return t=Array.isArray(t)?t.slice():[t],this.events.fire("store:data:set",{previous:e,data:t}),t},setAsync:async function(t){let e=this.options.get("store.data",[]);return t=Array.isArray(t)?t.slice():[],await this.events.fireAsync("store:data:set",{previous:e,data:t}),t},all:function(){return this.store.load()},get:function(t){let e=this.store.load();return typeof t!="number"||t<0||t>=e.length?null:e[t]}},extension:{_normalizeArray:function(t,e){return Array.isArray(t)?t.slice():Array.isArray(e)?e.slice():[]},_sortRows:function(t,e,n,o){let r=Array.isArray(t)?t.slice():[],i=typeof o=="function"?function(a,s){return o(a,s,n)}:function(a,s){let c=a&&Object.prototype.hasOwnProperty.call(a,e)?a[e]:void 0,f=s&&Object.prototype.hasOwnProperty.call(s,e)?s[e]:void 0,l=0;return c===f?l=0:c==null?l=-1:f==null?l=1:typeof c=="number"&&typeof f=="number"?l=c-f:l=String(c).localeCompare(String(f)),n==="desc"?-l:l};return r.sort(i),r}},events:[{for:"brick:status:ready",on:{fn:function(t){let e=this._normalizeArray(pt,[]);this.brick.options.setSilent("store.data",e)}}},{for:"store:data:set",on:{fn:function(t){let e=t&&t.data||null,n=e&&e.data?e.data:[];this.brick.options.setSilent("store.data",n)}}},{for:"store:data:sort",on:{fn:function(t){let e=t&&t.data||{},n=e.field||null,o=e.dir||"asc";if(!n||!this.brick)return;let r=this._sortRows(this.brick.store.load(),n,o,e.compare);this.brick.options.setSilent("store.data",r),t.field=n,t.dir=o,t.data=r}}}],init:function(){},destroy:function(){}},W=ht;var mt={for:[{host:"brick",kind:"*"}],requires:[],ns:"wire",options:{},brick:{notify:function(t,e){console.warn("WireClient > sending notify",t,e),console.log("	for event",t),console.log("	with payload",e),this.ext._service||this.ext._connect(),this.ext._service&&this.ext._service.events.fire("wire:notify:out",{from:this.brick.id,event:t,data:e})},request:function(t,e){console.warn("request",t,e),console.log("this",this),this.ext._service||this.ext._connect(),this.ext._service&&(console.log("this.service",this.ext._service),this.ext._service.events.fire("wire:request:out",{from:this.brick.id,event:t,data:e}))}},extension:{_service:null,_connect:function(){this.ext._service||this.brick.options.get("wire",null)==null||(globalThis.VanillaBrick&&globalThis.VanillaBrick.service&&(this.ext._service=globalThis.VanillaBrick.service("WireService")),this.ext._service?this.ext._service.events.fire("wire:register:in",{brick:this.brick,options:this.brick.options.get("wire",{})}):console.warn("[Wire Client] No Wire Service found.",this.ext._service))}},events:[{for:"brick:status:ready",on:{fn:function(){this._connect()}}}],init:function(){},destroy:function(){}},K=mt;var yt={for:[{host:"service",kind:"wire"}],requires:[],ns:"wire",options:{},brick:{},events:[{for:"wire:notify:out",on:{fn:function(t){console.warn("WireService > on wire:notify:out",t);let e=t.data.from;console.log("	from",e);let n=t.data.event;console.log("	evName",n);let o=t.data.data;console.log("	evData",o);let r=this.ext._slaves[e];if(console.log("	for slaves",r),r&&r.length>0)for(let i=0;i<r.length;i++)console.log("	- firing",n,"in",r[i].brick.id),r[i].brick.events.fire(n,o)}}},{for:"wire:register:in",on:{fn:function(t){this.ext._register(t.data)}}}],extension:{_register:function(t){if(console.warn("register",t.brick,t.options,this),t.options.master&&(this.ext._bricks==null&&(this.ext._bricks={}),this.ext._bricks[t.brick.id]=t.brick),t.options.slaveOf&&t.options.slaveOf.length>0){this.ext._masters==null&&(this.ext._masters={}),this.ext._slaves==null&&(this.ext._slaves={});for(let e=0;e<t.options.slaveOf.length;e++)this.ext._masters[t.brick.id]||(this.ext._masters[t.brick.id]=[]),this.ext._masters[t.brick.id].push({id:t.options.slaveOf[e].id,kind:t.options.slaveOf[e].kind}),this.ext._slaves[t.options.slaveOf[e].id]||(this.ext._slaves[t.options.slaveOf[e].id]=[]),this.ext._slaves[t.options.slaveOf[e].id].push({id:t.brick.id,kind:t.brick.kind,brick:t.brick})}console.log("_bricks",this.ext._bricks),console.log("_masters",this.ext._masters),console.log("_slaves",this.ext._slaves)}}},B=yt;var bt={for:[{host:"brick",kind:"form"}],requires:["dom"],ns:"items",options:{},brick:{get:function(){return this.options.get("form.items",[])}},extension:{_parseFromDom:function(){let t=this.brick.dom.element();if(!t)return[];let e=[],n=t.querySelectorAll(".vb-form-group");for(let o=0;o<n.length;o++){let r=n[o],i={type:"group",items:[]},a=r.querySelectorAll(".vb-form-field");for(let s=0;s<a.length;s++){let c=a[s],f=c.querySelector("input, select, textarea"),l=c.querySelector("label");if(f){let d={type:"field",name:f.name||f.id,label:l?l.textContent:"",controlType:f.tagName.toLowerCase(),inputType:f.type,required:f.required,placeholder:f.placeholder,span:this._detectSpan(c)};i.items.push(d)}}e.push(i)}return e},_detectSpan:function(t){let e=t;for(;e&&!e.classList.contains("vb-row");){if(e.className&&typeof e.className=="string"){let n=e.className.match(/vb-span-(\d+)/);if(n)return parseInt(n[1],10)}if(e=e.parentElement,!e||e.tagName==="FORM")break}return 12},_render:function(t){let e=this.brick.dom.element();if(e){e.innerHTML="";for(let n=0;n<t.length;n++){let o=t[n];if(o.type!=="group")continue;let r=document.createElement("div");r.className="vb-form-group";let i=document.createElement("div");if(i.className="vb-row",o.items&&o.items.length)for(let a=0;a<o.items.length;a++){let s=o.items[a],c=s.span||12,f=document.createElement("div");f.className="vb-span-"+c;let l=document.createElement("div");if(l.className="vb-form-field",s.label){let u=document.createElement("label");u.textContent=s.label,s.name&&(u.htmlFor=s.name),l.appendChild(u)}let d;s.controlType==="textarea"?d=document.createElement("textarea"):s.controlType==="select"?d=document.createElement("select"):(d=document.createElement("input"),d.type=s.inputType||"text"),s.name&&(d.name=s.name,d.id=s.name),s.placeholder&&(d.placeholder=s.placeholder),(s.required===!0||s.required==="true"||s.required==="required")&&(d.required=!0),l.appendChild(d),f.appendChild(l),i.appendChild(f)}r.appendChild(i),e.appendChild(r)}}}},events:[{for:"brick:status:ready",before:{fn:function(t){let e=[];if(this.brick.options.has("form.items")&&(e=this.brick.options.get("form.items")),!e||e.length===0){let n=this.brick.dom.element();if(n){let o=n.getAttribute("brick-form-items")||n.getAttribute("data-form-items");o&&window[o]&&(console.log("[Form Items] Config var found",o),e=window[o],this.brick.options.set("form.items",e))}(!e||e.length===0)&&(console.log("[Form Items] Parsing from DOM",this.brick.id),e=this._parseFromDom(),this.brick.options.set("form.items",e))}else console.log("[Form Items] Config found in options",e);t.data=t.data||{},t.data.formItems=e}},on:{fn:function(t){let e=t.data.formItems||this.brick.options.get("form.items");e&&e.length>0&&this._render(e)}}}],init:function(){return!0},destroy:function(){}},z=bt;var gt={for:[{host:"brick",kind:"form"}],requires:["dom","store"],ns:"record",options:{},brick:{getRecord:function(){let t=this.store.load();return t&&t.length?t[0]:null}},extension:{_bind:function(t){let e=this.brick.dom.element();if(!e)return;let n=e.querySelectorAll("input, select, textarea");for(let o=0;o<n.length;o++){let r=n[o],i=r.name||r.id;i&&(t&&Object.prototype.hasOwnProperty.call(t,i)?r.value=t[i]:t||(r.value=""))}}},events:[{for:"brick:status:ready",on:{fn:function(t){let e=this.brick.store.load();e&&e.length&&this._bind(e[0])}}},{for:"store:data:*",after:{fn:function(t){let e=this.brick.store.load(),n=e&&e.length?e[0]:null;this._bind(n)}}},{for:"dom:row:focus",after:{fn:function(t){console.warn("Form > master focused a row",t);let e=t.data.row;console.log("	record",e),this._bind(e)}}}],init:function(){return!0},destroy:function(){}},J=gt;var vt={for:[{host:"brick",kind:"form"}],requires:["dom"],ns:"form",options:{items:[]},brick:{submit:function(){let t=this.dom.element();t&&typeof t.submit=="function"&&t.submit()},reset:function(){let t=this.dom.element();t&&typeof t.reset=="function"&&t.reset()}},extension:{},events:[{for:"brick:status:ready",on:{fn:function(){}}}],init:function(){return!0},destroy:function(){}},U=vt;var xt={for:[{host:"brick",kind:"grid"}],requires:["dom","store"],ns:"columns",brick:{get:function(){return this.options.get("grid.columns",[])},sort:function(t,e){let o=this.columns.get().find(function(a){return a&&a.datafield===t})||{},r=this.options.get("grid.sort",{field:null,dir:null}),i=e;return i!=="asc"&&i!=="desc"&&(i=r.field===t&&r.dir==="asc"?"desc":"asc"),this.events.fire("store:data:sort",{field:t,dir:i,compare:typeof o.sort=="function"?o.sort:null}),i}},extension:{},events:[{for:"brick:status:ready",on:{fn:function(){let t=this.brick.columns.get(),e=this.brick.dom.element&&this.brick.dom.element();if(!e)return;let n=e.tagName&&e.tagName.toLowerCase()==="table"?e:e.querySelector&&e.querySelector("table");if(!n)return;let o=n.tHead?n.tHead:n.querySelector("thead");o||(o=n.createTHead?n.createTHead():n.insertBefore(document.createElement("thead"),n.firstChild));let r=o.rows&&o.rows[0]?o.rows[0]:o.insertRow();r.innerHTML="";let i=this.brick;for(let a=0;a<t.length;a+=1){let s=t[a]||{},c=document.createElement("th");c.textContent=s.label||s.datafield||"",s.sortable&&s.datafield&&(c.classList.add("vb-sortable"),c.addEventListener("click",function(f){return function(){i.columns.sort(f.datafield,null)}}(s))),r.appendChild(c)}}}},{for:"store:data:sort",after:{fn:function(t){this.brick.options.setSilent("grid.sort",{field:t.field,dir:t.dir||"asc"})}}}],init:function(){},destroy:function(){},options:{grid:{columns:[{datafield:"code",label:"Code",sortable:!0},{datafield:"name",label:"Name",sortable:!0}]}}},G=xt;var kt={for:[{host:"brick",kind:"grid"}],requires:["dom","rows","store"],ns:"rowsFocused",options:{},brick:{},extension:{_addTabIndex:function(){let t=this.brick.dom.element();if(!t)return;let e=t.querySelectorAll("tbody tr")||[];for(let n=0;n<e.length;n++){let o=e[n];o.hasAttribute("tabindex")||o.setAttribute("tabindex",n)}},_handleFocus:function(t){let e=this.brick.dom.element();if(!e)return;let n=t.closest("tr");if(!n)return;let o=e.querySelector("tr.vb-focused");o&&o.classList.remove("vb-focused"),n.classList.add("vb-focused");let r=Array.prototype.indexOf.call(n.parentNode.children,n),i=this.brick.store.get(r);this.brick.events.fire("dom:row:focus",{index:r,row:i,element:n})}},events:[{for:"brick:status:ready",on:{fn:function(){let t=this.brick.dom.element();if(t){let e=this;t.addEventListener("focusin",function(n){e._handleFocus(n.target)})}this._addTabIndex()}}},{for:"store:data:set",after:{fn:function(t){this._addTabIndex()}}},{for:"store:data:sort",after:{fn:function(){this._addTabIndex()}}},{for:"dom:row:focus",after:{fn:function(t){var e;(e=this.brick.wire)==null||e.notify("dom:row:focus",t.data)}}}],init:function(){},destroy:function(){}},$=kt;var _t={for:[{host:"brick",kind:"grid"}],requires:["dom","store","columns"],ns:"rows",options:{},brick:{render:function(){let t=this.dom.element();if(!t)return;let e=t.tagName&&t.tagName.toLowerCase()==="table"?t:t.querySelector&&t.querySelector("table");if(!e)return;let n=this.columns.get(),o=this.store.load(),r=e.tBodies&&e.tBodies.length?e.tBodies[0]:e.querySelector("tbody");r||(r=document.createElement("tbody"),e.appendChild(r)),r.innerHTML="";for(let i=0;i<o.length;i+=1){let a=o[i]||{},s=document.createElement("tr");for(let c=0;c<n.length;c+=1){let l=(n[c]||{}).datafield,d=document.createElement("td");d.textContent=l&&a[l]!==void 0&&a[l]!==null?a[l]:"",s.appendChild(d)}r.appendChild(s)}}},extension:{},events:[{for:"brick:status:ready",on:{fn:function(){this.brick.rows.render()}}},{for:"store:data:*",after:{fn:function(t){this.brick.rows.render()}}}],init:function(){},destroy:function(){}},Q=_t;var wt={for:[{host:"brick",kind:"grid"}],requires:["dom"],ns:"grid",options:{},brick:{refresh:function(){this.__gridExt&&this.__gridExt._refreshRows()},getSelection:function(){let t=this.__gridExt;if(!t)return{index:-1,row:null};let e=typeof t.selectedIndex=="number"?t.selectedIndex:-1,n=e>=0&&t.rows&&t.rows[e]?t.rows[e]:null;return{index:e,row:n}},clearSelection:function(){this.__gridExt&&this.__gridExt._setSelectedIndex(-1)}},extension:{table:null,rows:[],selectedIndex:-1,_findTable:function(){let t=this.brick.dom&&typeof this.brick.dom.element=="function"?this.brick.dom.element():null;if(!t||!t.querySelector)return this.table=null,null;let e=t.querySelector("table.vb-grid")||t.querySelector("table");return this.table=e||null,this.table},_refreshRows:function(){let t=this.table||this._findTable();if(!t){this.rows=[],this.selectedIndex=-1;return}let e=t.tBodies&&t.tBodies.length?t.tBodies[0]:t.querySelector("tbody"),n=e?e.rows:t.rows;this.rows=Array.prototype.slice.call(n||[]),this.selectedIndex>=this.rows.length&&(this.selectedIndex=-1)},_setSelectedIndex:function(t){let e=this.rows||[];if(!e.length){this.selectedIndex=-1;return}(typeof t!="number"||t<0||t>=e.length)&&(t=-1);for(let n=0;n<e.length;n+=1){let o=e[n];!o||!o.classList||(n===t?o.classList.add("vb-grid-row-selected"):o.classList.remove("vb-grid-row-selected"))}this.selectedIndex=t}},events:[{for:"brick:status:ready",on:{fn:function(){this._findTable(),this._refreshRows()}}},{for:"dom:click:*",on:{fn:function(t){let e=this.table||this._findTable();if(!e||!t||!t.data||!t.data.domEvent)return;let n=t.data.domEvent.target;if(!n)return;let o=n,r=null;for(;o&&o!==e;){if(o.tagName&&o.tagName.toLowerCase()==="tr"){r=o;break}o=o.parentNode}if(!r)return;this._refreshRows();let a=(this.rows||[]).indexOf(r);a!==-1&&(this.selectedIndex===a?this._setSelectedIndex(-1):this._setSelectedIndex(a))}}}],init:function(){return this.brick.__gridExt=this,this.table=null,this.rows=[],this.selectedIndex=-1,!0},destroy:function(){this.rows=[],this.table=null,this.selectedIndex=-1,this.brick&&delete this.brick.__gridExt}},X=wt;var Ot={for:[{host:"brick",kind:"status-bar"}],requires:["dom"],ns:"statusBar",events:[{for:"dom:row:focus",after:{fn:function(t){let e=t.data.row,n=this.brick.dom.element();n&&(n.textContent=`Wire OK -> Selected: ${e.name}`)}}}],init:function(){let t=this.brick.dom.element();t&&(t.textContent="Wire status: Waiting for grid...")}},Y=Ot;var At={kind:"wire"},et=At;function nt(t){N&&(t.extensions.domCss=N),H&&(t.extensions.domEvents=H),M&&(t.extensions.dom=M),W&&(t.extensions.store=W),K&&(t.extensions.wire=K),B&&(t.extensions.wireservice=B),z&&(t.extensions.formItems=z),J&&(t.extensions.formRecord=J),U&&(t.extensions.form=U),G&&(t.extensions.gridColumns=G),$&&(t.extensions.gridRowsFocused=$),Q&&(t.extensions.gridRows=Q),X&&(t.extensions.grid=X),Y&&(t.extensions.statusBar=Y),t.services.WireService=et}var S={brick:v,registry:q,utils:F,extensions:{},services:{},configs:{},runtime:{bricks:[],services:{}},base:{}};globalThis.VanillaBrick=S;nt(S);V(S);tt(S);var Ae=S;})();
//# sourceMappingURL=vanillabrick.min.js.map
